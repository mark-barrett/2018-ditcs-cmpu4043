(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(e,t,a){e.exports=a(64)},36:function(e,t,a){},52:function(e,t,a){},59:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(28),l=a.n(s),c=(a(36),a(66)),o=a(65),i="/chat",u=a(9),m=a(13),p=a(3),d=a(4),h=a(6),g=a(5),f=a(7),b=a(67),v=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"createErrors",value:function(){var e=[];return null!=this.props.errors&&(e=r.a.createElement("div",{className:"alert alert-secondary"},r.a.createElement("div",{className:"text-center"},this.props.errors.message))),e}},{key:"render",value:function(){return r.a.createElement("div",null,this.createErrors())}}]),t}(n.Component),E=r.a.createContext(null),y=function(e){return function(t){return r.a.createElement(E.Consumer,null,function(a){return r.a.createElement(e,Object.assign({},t,{firebase:a}))})}},N=E,O=a(20),j=a.n(O),S=(a(42),a(44),a(23)),C={apiKey:"AIzaSyBjT19b2eIHf3ZupAM5U8vb2is4ljS3pCw",authDomain:"react-chat-app-3d7d5.firebaseapp.com",databaseURL:"https://react-chat-app-3d7d5.firebaseio.com",projectId:"react-chat-app-3d7d5",storageBucket:"react-chat-app-3d7d5.appspot.com",messagingSenderId:"41737086563"},k=function e(){var t=this;Object(p.a)(this,e),this.doCreateUserWithEmailAndPassword=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.doSignInWithEmailAndPassword=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.doSignOut=function(){return t.auth.signOut()},this.user=function(e){return t.db.ref("users/".concat(e))},this.users=function(){return t.db.ref("users")},this.messages=function(){return t.db.ref("messages")},this.message=function(e){return t.db.ref("messages/".concat(e))},this.group=function(){return t.db.ref("groups")},j.a.initializeApp(C),this.auth=j.a.auth(),this.db=j.a.database()},w={username:"",email:"",password:"",confirmPassword:""},U=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).onChange=function(e){a.setState(Object(m.a)({},e.target.name,e.target.value))},a.onSubmit=function(e){var t=a.state,n=t.username,r=t.email,s=t.password;t.confirmPassowrd;a.props.firebase.doCreateUserWithEmailAndPassword(r,s).then(function(e){a.props.firebase.user(e.user.uid).set({username:n,email:r}).then(function(){a.setState(Object(u.a)({},w)),a.props.history.push(i)}).catch(function(e){a.setState({error:e})})}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.state=Object(u.a)({},w),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4"}),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"signup"},r.a.createElement(v,{errors:this.state.error}),r.a.createElement("h4",null,"React Chat App ",r.a.createElement("small",null,"Sign Up")),r.a.createElement("br",null),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"signup-form"},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",{id:"username",type:"text",name:"username",className:"form-control",onChange:this.onChange,value:this.state.username})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{id:"email",type:"email",name:"email",className:"form-control",onChange:this.onChange,value:this.state.email})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{id:"password",type:"password",name:"password",className:"form-control",onChange:this.onChange,value:this.state.password})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm Password"),r.a.createElement("input",{id:"confirmPassword",type:"password",name:"confirmPassword",className:"form-control",onChange:this.onChange,value:this.state.confirmPassword})),r.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},"Sign Up"),r.a.createElement("br",null),r.a.createElement("div",{className:"text-center"},r.a.createElement("p",null,"Already have an account? ",r.a.createElement("a",{href:"/"},"Login now."))))))))),r.a.createElement("div",{className:"col-md-4"}))}}]),t}(n.Component),I=Object(b.a)(y(U)),A=function(){return r.a.createElement("div",null,r.a.createElement(I,null))},x={email:"",password:""},M=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).onChange=function(e){a.setState(Object(m.a)({},e.target.name,e.target.value))},a.onSubmit=function(e){var t=a.state,n=t.email,r=t.password;a.props.firebase.doSignInWithEmailAndPassword(n,r).then(function(){a.setState(Object(u.a)({},x)),a.props.history.push(i)}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.state=Object(u.a)({},x),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4"}),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{className:"login"},r.a.createElement(v,{errors:this.state.error}),r.a.createElement("h4",null,"React Chat App ",r.a.createElement("small",null,"Login")),r.a.createElement("br",null),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"login-form"},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{id:"email",type:"email",name:"email",className:"form-control",onChange:this.onChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{id:"password",type:"password",name:"password",className:"form-control",onChange:this.onChange})),r.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},"Login")),r.a.createElement("br",null),r.a.createElement("div",{className:"text-center"},r.a.createElement("p",null,"Don't have an account? ",r.a.createElement("a",{href:"/signup"},"Sign Up now.")))))))),r.a.createElement("div",{className:"col-md-4"}))}}]),t}(n.Component),P=Object(b.a)(y(M)),D=function(){return r.a.createElement("div",null,r.a.createElement(P,null))},W=y(function(e){var t=e.firebase;return r.a.createElement("button",{type:"button",className:"btn btn-light",onClick:t.doSignOut},"Sign out")}),G=function(e){function t(e){return Object(p.a)(this,t),Object(h.a)(this,Object(g.a)(t).call(this,e))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement("a",{className:"navbar-brand",href:"#"},"React Chat App"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarText"},r.a.createElement("ul",{className:"navbar-nav mr-auto"}),r.a.createElement("span",{className:"navbar-text"},r.a.createElement("button",{type:"button",className:"btn btn-light"},"Logged in as ",this.props.loggedInAs),"\xa0",r.a.createElement(W,null)))))}}]),t}(n.Component),T=a(14),B=(a(22),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).createGroup=function(e){var t=a.state,n=t.groupName,r=t.groupMembers;a.props.firebase.group().push().set({name:n,members:r}),a.setState({groupName:"",groupMembers:[],createGroupOpen:!1}),e.preventDefault()},a.createGroupChange=function(e){if("groupName"==e.target.name)a.setState({groupName:e.target.value});else if("groupMembers"==e.target.name){for(var t=[],n=0,r=e.target.options.length;n<r;n++)e.target.options[n].selected&&t.push(e.target.options[n].value);t.push(a.props.loggedInAsID),a.setState({groupMembers:t})}},a.state={createGroupOpen:!1,groupName:"",groupMembers:[]},a.createGroupButtonClicked=a.createGroupButtonClicked.bind(Object(T.a)(Object(T.a)(a))),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"createGroupButtonClicked",value:function(){this.setState({createGroupOpen:!0})}},{key:"render",value:function(){return this.state.createGroupOpen?r.a.createElement("div",null,r.a.createElement("div",{className:"list-group-item list-group-item-action ",style:{borderRadius:"0px"}},r.a.createElement("form",{onSubmit:this.createGroup},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",name:"groupName",class:"form-control",placeholder:"Group Name",onChange:this.createGroupChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement("select",{multiple:!0,name:"groupMembers",className:"form-control",onChange:this.createGroupChange},this.props.users.map(function(e){return r.a.createElement("option",{value:e.uid},e.username)}))),r.a.createElement("button",{type:"submit",className:"btn btn-secondary btn-block"},r.a.createElement("i",{className:"fa fa-plus"})," Create Group")))):r.a.createElement("div",null,r.a.createElement("div",{className:"list-group-item list-group-item-action ",style:{borderRadius:"0px"}},r.a.createElement("button",{onClick:this.createGroupButtonClicked,className:"btn btn-secondary btn-block"},r.a.createElement("i",{className:"fa fa-plus"})," Create Group")))}}]),t}(n.Component)),L=y(B),R=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).state={users:[],groups:[],loading:!1,currentlySelectedUser:null},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0}),this.props.firebase.users().orderByChild("email").on("value",function(t){var a=t.val(),n=Object.keys(a).map(function(e){return Object(u.a)({},a[e],{uid:e})});n=n.filter(function(t){return t.email!=e.props.loggedInAs}),e.setState({users:n})}),this.props.firebase.group().on("value",function(t){var a=t.val(),n=Object.keys(a).map(function(e){return Object(u.a)({},a[e],{groupId:e})});n=n.filter(function(t){return t.members.includes(e.props.loggedInAsID)}),e.setState({groups:n})})}},{key:"componentWillUnmount",value:function(){this.props.firebase.users().off(),this.props.firebase.group().off()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"col-md-4",style:{marginRight:"0px",paddingRight:"0px"}},r.a.createElement("ul",{className:"list-group",style:{borderRadius:"0px"}},r.a.createElement(L,{loggedInAsID:this.props.loggedInAsID,users:this.state.users}),this.state.groups.map(function(t){return r.a.createElement("a",{onClick:function(){return e.props.changeWhoUserIsChattingTo(t.groupId)},className:"list-group-item list-group-item-action "+(e.props.currentlySelectedUser==t.groupId?"active":""),style:{borderRadius:"0px"}},r.a.createElement("h5",null,r.a.createElement("i",{className:"fa fa-users"})," ",t.name,r.a.createElement("br",null)))}),this.state.users.map(function(t){return r.a.createElement("a",{onClick:function(){return e.props.changeWhoUserIsChattingTo(t.uid)},className:"list-group-item list-group-item-action "+(e.props.currentlySelectedUser==t.uid?"active":""),style:{borderRadius:"0px"}},r.a.createElement("h5",null,r.a.createElement("i",{className:"fa fa-user"})," ",t.username,r.a.createElement("br",null),r.a.createElement("small",null,t.email)))})))}}]),t}(n.Component),F=y(R),z=(a(52),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).deleteMessage=function(e){a.props.firebase.message(e.currentTarget.value).remove()},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;if(this.props.currentlySelectedUser==this.props.message.from){var t=this.props.users.map(function(t){if(e.props.currentlySelectedUser==t.uid)return t.username});return r.a.createElement("div",null,r.a.createElement("div",{class:"float-left"},r.a.createElement("br",null),t,r.a.createElement("div",{className:"from-message"},this.props.message.body),r.a.createElement("div",{className:"float-left"},r.a.createElement("small",null,r.a.createElement("i",{className:"fa fa-clock-o"})," ",this.props.message.sentAt))),r.a.createElement("br",null),r.a.createElement("br",null))}if(this.props.loggedInAs==this.props.message.from){var a=this.props.users.map(function(t){if(e.props.loggedInAs==t.uid)return t.username});return r.a.createElement("div",null,r.a.createElement("div",{className:"float-right"},r.a.createElement("br",null),r.a.createElement("div",{className:"float-right"},a),r.a.createElement("br",null),r.a.createElement("div",{className:"to-message"},this.props.message.body),r.a.createElement("div",{className:"float-right"},r.a.createElement("small",null,r.a.createElement("i",{className:"fa fa-clock-o"})," ",this.props.message.sentAt," ",r.a.createElement("button",{className:"btn btn-secondary btn-sm",value:this.props.message.messageId,onClick:this.deleteMessage},r.a.createElement("i",{className:"fa fa-trash"}))))),r.a.createElement("br",null),r.a.createElement("br",null))}var n=this.props.users.map(function(t){if(e.props.message.from==t.uid)return t.username});return r.a.createElement("div",null,r.a.createElement("div",{class:"float-left"},r.a.createElement("br",null),n,r.a.createElement("div",{className:"from-message"},this.props.message.body),r.a.createElement("div",{className:"float-left"},r.a.createElement("small",null,r.a.createElement("i",{className:"fa fa-clock-o"})," ",this.props.message.sentAt))),r.a.createElement("br",null),r.a.createElement("br",null))}}]),t}(n.Component)),J=y(z),H={message:"",messages:[],userMessages:[]},K=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).onChange=function(e){a.setState({message:e.target.value})},a.sendMessage=function(e){var t=a.state.message;a.props.firebase.messages().push().set({from:a.props.loggedInAs,to:a.props.currentlySelectedUser,body:t,sentAt:(new Date).toLocaleString()}),a.setState({message:""}),e.preventDefault()},a.state=Object(u.a)({},H),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0}),this.props.firebase.messages().on("value",function(t){var a=t.val(),n=Object.keys(a).map(function(e){return Object(u.a)({},a[e],{messageId:e})});e.setState({messages:n})})}},{key:"render",value:function(){var e=this;if(0==this.props.currentlySelectedUser)return r.a.createElement("div",{className:"col-md-8",style:{marginLeft:"0px",paddingLeft:"0px"}},r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"text-center"},r.a.createElement("h1",null,"Please choose a user to chat to.")));for(var t=[],a=0;a<this.state.messages.length;a++)console.log(this.props.currentlySelectedUser),this.props.currentlySelectedUser.startsWith("-LS")?this.props.currentlySelectedUser==this.state.messages[a].to&&t.push(this.state.messages[a]):(this.state.messages[a].from==this.props.currentlySelectedUser&&this.state.messages[a].to==this.props.loggedInAs||this.state.messages[a].to==this.props.currentlySelectedUser&&this.state.messages[a].from==this.props.loggedInAs)&&t.push(this.state.messages[a]);return r.a.createElement("div",{className:"col-md-8",style:{marginLeft:"0px",paddingLeft:"0px"}},r.a.createElement("div",{className:"messages"},t.map(function(t){return r.a.createElement(J,{message:t,loggedInAs:e.props.loggedInAs,users:e.props.users,currentlySelectedUser:e.props.currentlySelectedUser})})),r.a.createElement("div",{className:"enterMessage"},r.a.createElement("form",{onSubmit:this.sendMessage},r.a.createElement("div",{className:"form-group"},r.a.createElement("textarea",{onChange:this.onChange,className:"form-control",placeholder:"Type a message...",value:this.state.message}),r.a.createElement("div",{className:"submitMessageButton"},r.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},"Send Message"))))))}}]),t}(n.Component),Z=y(K),$=r.a.createContext(null),q=function(e){var t=function(t){function a(e){var t;return Object(p.a)(this,a),(t=Object(h.a)(this,Object(g.a)(a).call(this,e))).state={authUser:null},t}return Object(f.a)(a,t),Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.listener=this.props.firebase.auth.onAuthStateChanged(function(t){t?e.setState({authUser:t}):e.setState({authUser:null})})}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){return r.a.createElement($.Provider,{value:this.state.authUser},r.a.createElement(e,this.props))}}]),a}(r.a.Component);return y(t)},Q=function(e){return function(t){var a=function(a){function n(){return Object(p.a)(this,n),Object(h.a)(this,Object(g.a)(n).apply(this,arguments))}return Object(f.a)(n,a),Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.listener=this.props.firebase.auth.onAuthStateChanged(function(a){e(a)||t.props.history.push("/")})}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){var a=this;return r.a.createElement($.Consumer,null,function(n){return e(n)?r.a.createElement(t,a.props):null})}}]),n}(r.a.Component);return Object(S.a)(b.a,y)(a)}},V=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).changeWhoUserIsChattingTo=function(e){a.setState({currentlySelectedUser:e})},a.state={users:[],currentlySelectedUser:0},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0}),this.props.firebase.users().orderByChild("email").on("value",function(t){var a=t.val(),n=Object.keys(a).map(function(e){return Object(u.a)({},a[e],{uid:e})});e.setState({users:n})})}},{key:"render",value:function(){var e=this;return r.a.createElement($.Consumer,null,function(t){return r.a.createElement("div",null,r.a.createElement(G,{loggedInAs:t.email}),r.a.createElement("div",{className:"row"},r.a.createElement(F,{loggedInAs:t.email,loggedInAsID:t.uid,changeWhoUserIsChattingTo:e.changeWhoUserIsChattingTo,currentlySelectedUser:e.state.currentlySelectedUser}),r.a.createElement(Z,{users:e.state.users,loggedInAs:t.uid,loggedInAsUsername:t,currentlySelectedUser:e.state.currentlySelectedUser})))})}}]),t}(n.Component),X=Q(function(e){return!!e})(V);a(54),a(56),a(59);a(61).config();var Y=q(function(){return r.a.createElement(c.a,null,r.a.createElement("div",null,r.a.createElement(o.a,{exact:!0,path:"/",component:D}),r.a.createElement(o.a,{exact:!0,path:"/signup",component:A}),r.a.createElement(o.a,{exact:!0,path:i,component:X})))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(N.Provider,{value:new k},r.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[31,2,1]]]);
//# sourceMappingURL=main.e6d38ed5.chunk.js.map